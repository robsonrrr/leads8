<!-- Informações do Cliente/Lead/Vendedor -->
<div class="bg-white rounded-lg shadow-sm mb-4 overflow-hidden border border-gray-200">
    <!-- Header com título e toggle -->
    <div class="bg-gradient-to-r from-green-50 to-emerald-50 px-4 py-3 border-b border-gray-200">
        <div class="flex items-center justify-between">
            <h3 class="text-lg font-semibold text-gray-800 flex items-center">
                <i class="fas fa-user-circle mr-2 text-green-600"></i>
                Informações do Lead
            </h3>
            <button onclick="toggleSection('lead-info')" 
                    class="flex items-center gap-2 px-3 py-1 bg-green-100 hover:bg-green-200 text-green-800 rounded-md transition-colors duration-200 text-sm font-medium">
                <i id="lead-info-icon" class="fas fa-eye-slash"></i>
                <span id="lead-info-text">Ocultar</span>
            </button>
        </div>
    </div>
    
    <!-- Informações organizadas em grid responsivo -->
    <div id="lead-info-content" class="p-4">
        <!-- Primeira linha: Informações principais -->
        <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4 mb-4">
            <!-- Data Criado -->
            <div class="flex items-center gap-3 p-3 bg-blue-50 rounded-lg border-l-4 border-blue-400">
                <div class="flex-shrink-0">
                    <i class="far fa-calendar-alt text-blue-600 text-lg"></i>
                </div>
                <div class="min-w-0">
                    <div class="text-xs font-medium text-blue-800 uppercase tracking-wide">Data Criado</div>
                    <div class="text-sm text-gray-800 font-medium">{{dataEmissaoFormatado}}</div>
                    <div class="text-xs text-gray-600">{{dataEmissaoDias}} dia(s)</div>
                </div>
            </div>

            <!-- Vendedor/Emissor -->
            <div class="flex items-center gap-3 p-3 bg-purple-50 rounded-lg border-l-4 border-purple-400">
                <div class="flex-shrink-0">
                    <i class="fas fa-user-tie text-purple-600 text-lg"></i>
                </div>
                <div class="min-w-0">
                    <div class="text-xs font-medium text-purple-800 uppercase tracking-wide">Vendedor/Emissor</div>
                    <div class="text-sm text-gray-800 font-medium truncate">
                        {{Cliente.Gerente.UsuarioNomeCurto}} / {{Vendedor.UsuarioNomeCurto}}
                    </div>
                </div>
            </div>

            <!-- Financeiro -->
            <div class="flex items-center gap-3 p-3 bg-green-50 rounded-lg border-l-4 border-green-400">
                <div class="flex-shrink-0">
                    <i class="far fa-money-bill-alt text-green-600 text-lg"></i>
                </div>
                <div class="min-w-0">
                    <div class="text-xs font-medium text-green-800 uppercase tracking-wide">Financeiro</div>
                    <div class="text-sm text-gray-800 font-medium">
                        {{#Financeiro}}{{limite}} / {{disponivel}} / {{#atrasados}}{{atrasados}}{{/atrasados}}{{^atrasados}}0{{/atrasados}}{{/Financeiro}}
                    </div>
                    <div class="text-xs text-gray-600">Limite / Disponível / Atrasados</div>
                </div>
            </div>

            <!-- Cadastro -->
            <div class="flex items-center gap-3 p-3 bg-orange-50 rounded-lg border-l-4 border-orange-400">
                <div class="flex-shrink-0">
                    <i class="fas fa-users-cog text-orange-600 text-lg"></i>
                </div>
                <div class="min-w-0">
                    <div class="text-xs font-medium text-orange-800 uppercase tracking-wide">Cadastro</div>
                    <div class="text-xs text-gray-800 space-y-1">
                        {{#Cliente}}
                        <div><span class="font-medium">Desc:</span> {{clienteDesconto}}, {{clienteDescontoMakAutomotive}}, {{clienteDescontoPedido}}</div>
                        <div><span class="font-medium">Juros:</span> {{clienteJuros}} | <span class="font-medium">ST:</span> {{clienteSobretaxa}}</div>
                        {{/Cliente}}
                    </div>
                </div>
            </div>
        </div>

        <!-- Segunda linha: Campos editáveis -->
        <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4">
            <!-- Fonte -->
            <div class="bg-gray-50 rounded-lg p-3">
                <div class="flex items-center gap-2 mb-2">
                    <i class="fab fa-font-awesome-flag text-indigo-600"></i>
                    <label class="text-sm font-medium text-gray-700 flex items-center gap-1">
                        Fonte
                        <i class="fas fa-question-circle text-gray-400 cursor-help" 
                           title="0 - desconhecido, 1 - B2B, 2 - B2C, 3 - ML, 4 - B2W, 5 - Shopee, 6 - Magalu, 7 - Viavarejo, 8 - Amazon, 9 - Instagram, 10 - Facebook, 11 - Youtube, 12 - Visita, 13 - Campanha, 14 - Promoção, 15 - Email marketing"></i>
                    </label>
                </div>
                {{#pedidoPOID}}
                       <div class="w-full bg-gray-100 rounded-md py-2 px-3 text-sm">{{leadFonte}}</div>
                       {{/pedidoPOID}}
                       {{^pedidoPOID}}
                       <input type="text" 
                       class="w-full border border-gray-300 rounded-md py-2 px-3 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-300" 
                       value="{{leadFonte}}"
                       data-url="/leads/leads5/lead/update/Leads/{{id}}"
                       name="leadFonte" id="leadFonte"
                       placeholder="Digite o código da fonte">
                       {{/pedidoPOID}}
            </div>

            <!-- Tipo -->
            <div class="bg-gray-50 rounded-lg p-3">
                <div class="flex items-center gap-2 mb-2">
                    <i class="fas fa-tag text-pink-600"></i>
                    <label class="text-sm font-medium text-gray-700 flex items-center gap-1">
                        Tipo
                        <i class="fas fa-question-circle text-gray-400 cursor-help" 
                           title="1 - Ativa, 2 - Receptivo"></i>
                    </label>
                </div>
                {{#pedidoPOID}}
                       <div class="w-full bg-gray-100 rounded-md py-2 px-3 text-sm">{{leadTipo}}</div>
                       {{/pedidoPOID}}
                       {{^pedidoPOID}}
                       <input type="text" 
                       class="w-full border border-gray-300 rounded-md py-2 px-3 text-sm focus:outline-none focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all duration-300" 
                       value="{{leadTipo}}"
                       data-url="/leads/leads5/lead/update/Leads/{{id}}"
                       name="leadTipo" id="leadTipo"
                       placeholder="Digite o tipo">
                       {{/pedidoPOID}}
            </div>

            <!-- Emitente -->
            <div class="bg-gray-50 rounded-lg p-3">
                <div class="flex items-center gap-2 mb-2">
                    <i class="fas fa-building text-teal-600"></i>
                    <label class="text-sm font-medium text-gray-700">Emitente</label>
                </div>
                {{#pedidoPOID}}
                    <div class="w-full bg-gray-100 rounded-md py-2 px-3 text-sm">{{#Emitente}}{{emitenteFantasia}}{{/Emitente}}</div>
                    {{/pedidoPOID}}
                    {{^pedidoPOID}}
                    <select class="w-full border border-gray-300 rounded-md py-2 px-3 text-sm focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent transition-all duration-300"
                        data-field="unidadeEmitentePOID"
                        data-lead="{{id}}"
                        data-ajax-update="{{CONTAINER}}service/update/"
                        data-ajax--url="{{CONTAINER}}service/emit/">
                    {{#Emitente}}<option value="{{emitenteFantasia}}" selected>{{emitenteFantasia}}</option>{{/Emitente}}
                    </select>
                    {{/pedidoPOID}}
            </div>

            <!-- Faturar para -->
            <div class="bg-gray-50 rounded-lg p-3">
                <div class="flex items-center gap-2 mb-2">
                    <i class="fas fa-file-invoice text-red-600"></i>
                    <label class="text-sm font-medium text-gray-700">Faturar para</label>
                </div>
                {{#pedidoPOID}}
                    <div class="w-full bg-gray-100 rounded-md py-2 px-3 text-sm">{{#ClienteDoCliente}}{{clienteNome}}{{/ClienteDoCliente}}{{^ClienteDoCliente}}{{Cliente.clienteNome}}{{/ClienteDoCliente}}</div>
                    {{/pedidoPOID}}
                    {{^pedidoPOID}}
                    <select class="w-full border border-gray-300 rounded-md py-2 px-3 text-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all duration-300"
                        data-field="clienteDoClientePOID"
                        data-lead="{{id}}"
                        data-ajax-update="{{CONTAINER}}service/update/"
                        data-ajax--url="{{CONTAINER}}service/auto/cc_{{clientePOID}}/">
                    {{#ClienteDoCliente}}<option value="{{clienteNome}}" selected>{{clienteNome}}</option>{{/ClienteDoCliente}}
                    {{^ClienteDoCliente}}<option value="{{Cliente.clienteNome}}" selected>{{Cliente.clienteNome}}</option>{{/ClienteDoCliente}}
                    </select>
                    {{/pedidoPOID}}
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Função para controlar toggle das seções
    window.toggleSection = function(sectionId) {
        const content = document.getElementById(sectionId + '-content');
        const icon = document.getElementById(sectionId + '-icon');
        const text = document.getElementById(sectionId + '-text');
        
        if (content && icon && text) {
            if (content.style.display === 'none') {
                // Mostrar seção
                content.style.display = 'block';
                icon.className = 'fas fa-eye-slash';
                text.textContent = 'Ocultar';
                // Salvar estado
                localStorage.setItem('section_' + sectionId, 'visible');
            } else {
                // Ocultar seção
                content.style.display = 'none';
                icon.className = 'fas fa-eye';
                text.textContent = 'Mostrar';
                // Salvar estado
                localStorage.setItem('section_' + sectionId, 'hidden');
            }
        }
    };

    // Carregar estado das seções do localStorage
    function loadSectionStates() {
        const sections = ['lead-info'];
        sections.forEach(sectionId => {
            const savedState = localStorage.getItem('section_' + sectionId);
            const content = document.getElementById(sectionId + '-content');
            const icon = document.getElementById(sectionId + '-icon');
            const text = document.getElementById(sectionId + '-text');
            
            if (content && icon && text) {
                // Se não há estado salvo ou se está marcado como hidden, ocultar por padrão
                if (!savedState || savedState === 'hidden') {
                    content.style.display = 'none';
                    icon.className = 'fas fa-eye';
                    text.textContent = 'Mostrar';
                    // Salvar estado como hidden se não existir
                    if (!savedState) {
                        localStorage.setItem('section_' + sectionId, 'hidden');
                    }
                } else {
                    // Se está marcado como visible, mostrar
                    content.style.display = 'block';
                    icon.className = 'fas fa-eye-slash';
                    text.textContent = 'Ocultar';
                }
            }
        });
    }

    // Carregar estados salvos quando a página carrega
    loadSectionStates();
});
</script>


