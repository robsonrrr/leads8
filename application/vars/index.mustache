<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Variáveis do Sistema</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" rel="stylesheet" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous">
    
    <style>
        .editable-field {
            transition: background-color 0.2s ease;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .editable-field:hover {
            background-color: #f8f9fa !important;
        }
        
        .card-hover {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .metric-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
        }
        
        .metric-card .card-body {
            padding: 1.5rem;
        }
        
        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 0;
        }
        
        .metric-label {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 0;
        }
        
        body {
            background-color: #f8f9fa;
        }
        
        .main-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
        }
        
        @media (min-width: 1200px) {
            .col-xl-1-5 {
                flex: 0 0 auto;
                width: 12.5%;
            }
        }
    </style>
</head>
<body>
    <!-- Header Principal -->
    <div class="main-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1 class="mb-0"><i class="fas fa-cogs me-3"></i>Variáveis do Sistema</h1>
                    <p class="mb-0 mt-2 opacity-75">Configurações e metas operacionais</p>
                </div>
                <div class="col-md-4 text-end">
                    <button class="btn btn-light" onclick="exportToCSV()">
                        <i class="fas fa-download me-2"></i>Exportar CSV
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="container-fluid">
        {{#vars}}
        
        <!-- Métricas Principais -->
        <div class="row mb-4">
            <div class="col-md-6 col-lg-3 mb-3">
                <div class="card metric-card h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-database fa-2x mb-3"></i>
                        <p class="metric-value">{{total_records}}</p>
                        <p class="metric-label">Total de Registros</p>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3 mb-3">
                <div class="card metric-card h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-dollar-sign fa-2x mb-3"></i>
                        <p class="metric-value">R$ {{Dolar}}</p>
                        <p class="metric-label">Taxa do Dólar</p>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3 mb-3">
                <div class="card metric-card h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-yen-sign fa-2x mb-3"></i>
                        <p class="metric-value">R$ {{Yuan}}</p>
                        <p class="metric-label">Taxa do Yuan</p>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3 mb-3">
                <div class="card metric-card h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-building fa-2x mb-3"></i>
                        <p class="metric-value">{{Buildings}}</p>
                        <p class="metric-label">Edifícios</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Taxas de Câmbio -->
        <div class="row mb-4">
            <div class="col-12">
                <h6 class="text-muted mb-3"><i class="fas fa-exchange-alt me-2"></i>Taxas de Câmbio</h6>
                <button class="btn btn-primary btn-sm mb-3">
                    <i class="fas fa-sync-alt me-2"></i>Atualizar Taxas
                </button>
            </div>
            <div class="col-6 col-sm-4 col-md-3 col-lg-2 col-xl-1-5 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body text-center">
                        <i class="fas fa-dollar-sign fa-2x text-success mb-2"></i>
                        <h6 class="card-title">Dólar (USD)</h6>
                        <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                            <span class="badge bg-success fs-6">{{Dolar}}</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-6 col-sm-4 col-md-3 col-lg-2 col-xl-1-5 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body text-center">
                        <i class="fas fa-yen-sign fa-2x text-info mb-2"></i>
                        <h6 class="card-title">Yuan (CNY)</h6>
                        <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                            <span class="badge bg-info fs-6">{{Yuan}}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dados Financeiros -->
        <div class="row mb-4">
            <div class="col-12">
                <h6 class="text-muted mb-3"><i class="fas fa-chart-line me-2"></i>Dados Financeiros</h6>
            </div>
            <div class="col-6 col-sm-4 col-md-3 col-lg-2 col-xl-1-5 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body text-center">
                        <i class="fas fa-money-bill-wave fa-2x text-primary mb-2"></i>
                        <h6 class="card-title">Cash</h6>
                        <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                            <span class="badge bg-primary fs-6">{{Cash}}</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-6 col-sm-4 col-md-3 col-lg-2 col-xl-1-5 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body text-center">
                        <i class="fas fa-plus-circle fa-2x text-success mb-2"></i>
                        <h6 class="card-title">Fix Plus</h6>
                        <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                            <span class="badge bg-success fs-6">{{FixPlus}}</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-6 col-sm-4 col-md-3 col-lg-2 col-xl-1-5 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body text-center">
                        <i class="fas fa-minus-circle fa-2x text-danger mb-2"></i>
                        <h6 class="card-title">Fix Less</h6>
                        <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                            <span class="badge bg-danger fs-6">{{FixLess}}</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-6 col-sm-4 col-md-3 col-lg-2 col-xl-1-5 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body text-center">
                        <i class="fas fa-building fa-2x text-warning mb-2"></i>
                        <h6 class="card-title">Edifícios</h6>
                        <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                            <span class="badge bg-warning fs-6">{{Buildings}}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Metas Principais -->
        <div class="row mb-4">
            <div class="col-12">
                <h6 class="text-muted mb-3"><i class="fas fa-bullseye me-2"></i>Metas Principais</h6>
            </div>
            <div class="col-6 col-sm-4 col-md-3 col-lg-2 col-xl-1-5 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body text-center">
                        <i class="fas fa-calendar-day fa-2x text-success mb-2"></i>
                        <h6 class="card-title">Sets Diário</h6>
                        <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                            <span class="badge bg-success fs-6">{{TargetSetsMachinesDaily}}</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-6 col-sm-4 col-md-3 col-lg-2 col-xl-1-5 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body text-center">
                        <i class="fas fa-cogs fa-2x text-info mb-2"></i>
                        <h6 class="card-title">Máquinas</h6>
                        <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                            <span class="badge bg-info fs-6">{{Target_Machines}}</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-6 col-sm-4 col-md-3 col-lg-2 col-xl-1-5 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body text-center">
                        <i class="fas fa-circle fa-2x text-warning mb-2"></i>
                        <h6 class="card-title">Rolamentos</h6>
                        <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                            <span class="badge bg-warning fs-6">{{Target_Bearings}}</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-6 col-sm-4 col-md-3 col-lg-2 col-xl-1-5 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body text-center">
                        <i class="fas fa-wrench fa-2x text-secondary mb-2"></i>
                        <h6 class="card-title">Peças</h6>
                        <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                            <span class="badge bg-secondary fs-6">{{Target_Parts}}</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-6 col-sm-4 col-md-3 col-lg-2 col-xl-1-5 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body text-center">
                        <i class="fas fa-car fa-2x text-danger mb-2"></i>
                        <h6 class="card-title">Auto</h6>
                        <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                            <span class="badge bg-info fs-6">{{Target_Auto}}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Metas Detalhadas - Máquinas -->
        <div class="row mb-4">
            <div class="col-12">
                <h6 class="text-muted mb-3"><i class="fas fa-cogs me-2"></i>Metas Máquinas</h6>
            </div>
            <div class="col-6 col-sm-4 col-md-3 col-lg-2 col-xl-1-5 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body text-center">
                        <i class="fas fa-users fa-2x text-success mb-2"></i>
                        <h6 class="card-title">Clientes</h6>
                        <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                            <span class="badge bg-success fs-6">{{TargetMachinesCustomers}}</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-6 col-sm-4 col-md-3 col-lg-2 col-xl-1-5 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body text-center">
                        <i class="fas fa-city fa-2x text-success mb-2"></i>
                        <h6 class="card-title">Cidades</h6>
                        <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                            <span class="badge bg-success fs-6">{{TargetMachinesCidades}}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Metas Detalhadas - Rolamentos -->
        <div class="row mb-4">
            <div class="col-12">
                <h6 class="text-muted mb-3"><i class="fas fa-circle me-2"></i>Metas Rolamentos</h6>
            </div>
            <div class="col-md-6 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div class="flex-shrink-0">
                                <i class="fas fa-users fa-2x text-warning"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="card-title mb-1">Clientes</h6>
                                <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                                    <span class="badge bg-warning fs-6">{{TargetBearingsCustomers}}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div class="flex-shrink-0">
                                <i class="fas fa-city fa-2x text-warning"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="card-title mb-1">Cidades</h6>
                                <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                                    <span class="badge bg-warning fs-6">{{TargetBearingsCidades}}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Metas Detalhadas - Auto -->
        <div class="row mb-4">
            <div class="col-12">
                <h6 class="text-muted mb-3"><i class="fas fa-car me-2"></i>Metas Auto</h6>
            </div>
            <div class="col-md-6 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div class="flex-shrink-0">
                                <i class="fas fa-users fa-2x text-danger"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="card-title mb-1">Clientes</h6>
                                <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                                    <span class="badge bg-danger fs-6">{{TargetAutoCustomers}}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div class="flex-shrink-0">
                                <i class="fas fa-city fa-2x text-danger"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="card-title mb-1">Cidades</h6>
                                <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                                    <span class="badge bg-danger fs-6">{{TargetAutoCidades}}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Metas Detalhadas - Peças -->
        <div class="row mb-4">
            <div class="col-12">
                <h6 class="text-muted mb-3"><i class="fas fa-wrench me-2"></i>Metas Peças</h6>
            </div>
            <div class="col-md-6 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div class="flex-shrink-0">
                                <i class="fas fa-users fa-2x text-secondary"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="card-title mb-1">Clientes</h6>
                                <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                                    <span class="badge bg-secondary fs-6">{{TargetPartsCustomers}}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div class="flex-shrink-0">
                                <i class="fas fa-city fa-2x text-secondary"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="card-title mb-1">Cidades</h6>
                                <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                                    <span class="badge bg-secondary fs-6">{{TargetPartsCidades}}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Financeiro -->
        <div class="row mb-4">
            <div class="col-12">
                <h6 class="text-muted mb-3"><i class="fas fa-money-bill-wave me-2"></i>Financeiro</h6>
            </div>
            <div class="col-md-6 col-lg-4 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body text-center">
                        <i class="fas fa-hand-holding-usd fa-2x text-success mb-2"></i>
                        <h6 class="card-title">A Pagar</h6>
                        <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                            <span class="badge bg-success fs-6">{{APagar}}</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-4 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body text-center">
                        <i class="fas fa-check-circle fa-2x text-info mb-2"></i>
                        <h6 class="card-title">Pago</h6>
                        <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                            <span class="badge bg-info fs-6">{{Pago}}</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-4 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body text-center">
                        <i class="fas fa-coins fa-2x text-warning mb-2"></i>
                        <h6 class="card-title">Recebido</h6>
                        <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                            <span class="badge bg-warning fs-6">{{Recebido}}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Funcionários -->
        <div class="row mb-4">
            <div class="col-12">
                <h6 class="text-muted mb-3"><i class="fas fa-users me-2"></i>Funcionários</h6>
            </div>
            <div class="col-md-6 col-lg-3 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body text-center">
                        <i class="fas fa-user-tie fa-2x text-primary mb-2"></i>
                        <h6 class="card-title">Vendedores</h6>
                        <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                            <span class="badge bg-primary fs-6">{{FuncionariosVendedores}}</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body text-center">
                        <i class="fas fa-tools fa-2x text-dark mb-2"></i>
                        <h6 class="card-title">Técnicos</h6>
                        <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                            <span class="badge bg-dark fs-6">{{FuncionariosTecnicos}}</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body text-center">
                        <i class="fas fa-headset fa-2x text-success mb-2"></i>
                        <h6 class="card-title">Atendimento</h6>
                        <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                            <span class="badge bg-success fs-6">{{FuncionariosAtendimento}}</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3 mb-3">
                <div class="card h-100 card-hover">
                    <div class="card-body text-center">
                        <i class="fas fa-user-cog fa-2x text-info mb-2"></i>
                        <h6 class="card-title">Administrativo</h6>
                        <div class="editable-field" style="padding: 8px; border-radius: 4px;">
                            <span class="badge bg-info fs-6">{{FuncionariosAdministrativo}}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        {{/vars}}

    <script>
        function exportToCSV() {
            try {
                const cards = document.querySelectorAll('.card');
                let csvContent = 'Campo,Valor\n';
                
                cards.forEach(card => {
                    const title = card.querySelector('.card-title');
                    const value = card.querySelector('.badge');
                    if (title && value) {
                        const titleText = title.textContent.trim().replace(/"/g, '""');
                        const valueText = value.textContent.trim().replace(/"/g, '""');
                        csvContent += `"${titleText}","${valueText}"\n`;
                    }
                });
                
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', 'variaveis_sistema.csv');
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } catch (error) {
                console.error('Erro ao exportar CSV:', error);
                alert('Ocorreu um erro ao exportar os dados. Tente novamente.');
            }
        }

        document.addEventListener('visibilitychange', () => {
            if (document.visibilityState === 'visible') {
                setTimeout(() => {
                    window.location.reload();
                }, 300000);
            }
        });
    </script>
</body>
</html>